# سیستم مدیریت عملکرد پرسنل اورژانس - نسخه پیشرفته

## 🚀 ویژگی‌های جدید پیاده‌سازی شده

### ✨ تخصیص ویژه و سریع شیفت

سیستم به‌روزرسانی شده با قابلیت‌های پیشرفته شامل:

#### 1. انتخاب پرسنل (سه حالت)

##### حالت دستی
- انتخاب مستقیم پرسنل از لیست
- امکان جستجو بر اساس نام
- انتخاب همه یا لغو انتخاب دسته‌ای

##### حالت فیلتری  
- فیلتر بر اساس وضعیت بهره‌وری (فعال/غیرفعال)
- فیلتر بر اساس وضعیت استخدامی (رسمی/طرحی)
- فیلتر بر اساس سابقه کاری (۰-۴، ۴-۸، ۸-۱۲، ۱۲-۱۶، ۱۶+ سال)

##### حالت پیشرفته (⭐ جدید)
- فیلتر شرطی بر اساس آمار عملکرد:
  - **تعداد شیفت**: کمتر از/بیشتر از/برابر با/بین مقادیر مشخص
  - **مجموع ساعات کاری**: فیلتر بر اساس جمع ساعات کارکرد
  - **روزهای مرخصی**: تعداد روزهای مرخصی گرفته شده
  - **اضافه کار**: مجموع ساعات اضافه‌کار
- امکان افزودن چندین شرط همزمان
- نمایش آمار عملکرد هر پرسنل در لیست

#### 2. تخصیص شیفت با امکانات پیشرفته

##### تخصیص چندگانه
- امکان افزودن چندین شیفت مختلف همزمان
- تعیین تعداد برای هر شیفت (قابلیت تکرار)
- انتخاب پایگاه مجزا برای هر شیفت

##### انتخاب پیشرفته روزها
- **حالت شبکه‌ای (Grid)**: نمایش تقویمی روزهای ماه
  - رنگ‌بندی روزهای تعطیل (قرمز)
  - نمایش روزهای خالی و پر برای هر پرسنل
  - انتخاب آسان با کلیک روی روزها
  
- **حالت انتخاب سریع**: 
  - دکمه "تخصیص به روزهای خالی"
  - شناسایی خودکار روزهای بدون شیفت
  - تخصیص هوشمند به روزهای موجود

#### 3. تایید نهایی و اعمال تغییرات
- دکمه "تایید و اعمال تغییرات" برای تأیید نهایی
- بررسی صحت اطلاعات قبل از ثبت
- پیام تأیید با جزئیات تخصیص انجام شده

## 🛠️ بهبودهای فنی

### پایگاه داده Supabase
- ✅ اتصال کامل به پایگاه داده Supabase
- ✅ رفع مشکلات دکمه‌های ذخیره موقت و نهایی
- ✅ مدیریت خطاهای پایگاه داده
- ✅ تست عملیات ذخیره‌سازی

### عملکرد سیستم
- بهینه‌سازی کوئری‌های پایگاه داده
- مدیریت حافظه و state
- پردازش سریع فیلترهای پیشرفته

## 📋 راهنمای استفاده

### دسترسی به سیستم
- **URL تولید**: https://3000-ifnur88yj0szlpu86sjwu-6532622b.e2b.dev
- **GitHub Repository**: https://github.com/robertmandory-alt/P88

### مراحل استفاده از تخصیص ویژه

1. **ورود به پنل ادمین**
   - انتخاب "نظارت بر عملکرد" از منو

2. **انتخاب ماه و سال**
   - تنظیم فیلترهای اولیه
   - کلیک "اعمال فیلتر"

3. **فعال‌سازی حالت ویرایش**
   - کلیک "🔒 حالت مشاهده" برای تغییر به "🔓 حالت ویرایش"

4. **باز کردن تخصیص ویژه**
   - کلیک "🎯 تخصیص ویژه و سریع شیفت"

5. **انتخاب پرسنل**
   - انتخاب یکی از سه حالت: دستی، فیلتری، یا پیشرفته
   - در حالت پیشرفته: افزودن شرطهای آماری

6. **تعیین شیفت‌ها**
   - افزودن شیفت‌های مختلف
   - تعیین تعداد و پایگاه برای هر شیفت

7. **انتخاب روزها**
   - استفاده از حالت شبکه‌ای برای انتخاب دقیق
   - یا استفاده از "تخصیص به روزهای خالی" برای انتخاب سریع

8. **تأیید و اعمال**
   - کلیک "تایید و اعمال تغییرات"
   - ذخیره موقت یا نهایی

## 🎯 ویژگی‌های کلیدی

### فیلترهای هوشمند
- انتخاب پرسنل بر اساس عملکرد گذشته
- تعیین شرطهای ترکیبی برای انتخاب بهینه
- نمایش آمار در زمان واقعی

### مدیریت زمان
- تقویم تعاملی برای انتخاب روزها  
- شناسایی خودکار روزهای خالی
- رنگ‌بندی روزهای تعطیل

### چندگانه‌سازی
- تخصیص چندین شیفت همزمان
- تعدد پرسنل و روزها
- امکان تکرار شیفت‌ها

## 📊 مدل داده

### جداول اصلی
- **personnel**: اطلاعات پرسنل
- **shifts**: انواع شیفت‌ها
- **bases**: پایگاه‌های کاری
- **performance_records**: رکوردهای عملکرد
- **performance_submissions**: وضعیت ارسال‌ها

### ساختار پایگاه داده
```sql
performance_records (
  id, personnel_id, day, shift_id, 
  base_id, submitting_base_id, year_month
)

performance_submissions (
  year_month, base_id, status, 
  created_at, updated_at
)
```

## 🔧 وضعیت deployment

- **پلتفرم**: React + TypeScript + Supabase
- **وضعیت**: ✅ فعال و تست شده
- **آخرین بروزرسانی**: ۱۵ مهر ۱۴۰۳
- **تکنولوژی**: Vite + TailwindCSS

## 🔍 تست‌های انجام شده

✅ تست اتصال پایگاه داده  
✅ تست عملیات ذخیره‌سازی  
✅ تست فیلترهای پیشرفته  
✅ تست انتخاب روزهای خالی  
✅ تست تخصیص چندگانه  
✅ تست رابط کاربری فارسی  

## 🚀 مراحل بعدی پیشنهادی

1. افزودن گزارش‌گیری پیشرفته
2. سیستم اعلان‌های خودکار
3. تحلیل عملکرد با نمودار
4. صادرات به Excel
5. تایید چندمرحله‌ای
6. لاگ تغییرات تفصیلی

---

**توسعه‌دهنده**: سیستم هوشمند مدیریت منابع انسانی  
**پشتیبانی**: پایگاه داده Supabase  
**نسخه**: 2.0 Enhanced